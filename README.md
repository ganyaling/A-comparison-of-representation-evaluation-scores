# A Comparison of Representation Internal Scores with Image Classification

This repository contains the official implementation for a Master’s thesis project investigating whether representation internal scores can reliably predict downstream image classification performance.

We evaluate a set of internal scoring methods across:

- Self-Supervised Learning (SSL) models — MoCo, DINO, SimCLR  
- Classical dimensionality reduction methods — PCA and UMAP  

The goal is to examine how these scores behave across different image datasets and representation learning approaches, and to assess whether the scores generalize beyond SSL to classical methods.

---

## Pre-trained Models Used

### MoCo  
Three checkpoints downloaded from:  
https://github.com/facebookresearch/moco/blob/main/README.md

### DINO  
Four checkpoints (ViT-S/8, ViT-S/16, ViT-B/8, ViT-B/16) downloaded from:  
https://github.com/facebookresearch/dino/blob/main/README.md

### SimCLR  
Three checkpoints downloaded from:  
https://github.com/sthalles/SimCLR/blob/master/README.md

---

## Repository Structure

### Folder: `eval/`

- **model.py**  
  Extracts parameters and backbone encoders from SSL checkpoints.

- **generate.py**  
  Learns representations from backbone encoders.  
  Generates two sets of representations: original images and augmented images (required for the alignment score).

- **eval_methods.py**  
  Defines all internal scoring methods used in the experiments.  
  MCR2 and Align-Uniform implementations are adapted due to local resource limitations.  
  - MCR2: https://github.com/ryanchankh/mcr2/blob/master/loss.py  
  - Alignment & Uniformity: https://github.com/ssnl/align_uniform/blob/master/align_uniform/__init__.py

- **eval_loss.py**  
  Computes internal scores for learned representations.

- **eval_mcr2_sweep.py**  
  Computes MCR2 for different K values.

- **test_tinyimagenet_val.py**  
  Utility script to verify TinyImageNet validation loading.

- **linear_dino.py**, **linear_moco.py**, **linear_simclr.py**  
  Train linear classifiers on top of SSL representations for linear probing.

- **linear_acc2.py**  
  Computes linear classification accuracy over epochs.

---

### Folder: `visual_method/`

- **linear.py**, **ssl.py**  
  Learn representations for linear probing and internal score evaluation.

- **linear_sub_pca.py**, **linear_sub_umap.py**  
  Subsample 30 representation vectors from PCA and UMAP embeddings.

- **ssl_sub.py**  
  Subsample 30 representation vectors from SSL embeddings.

- **eval_sublinear.py**, **eval_subssl.py**  
  Compute linear probing accuracy and internal scores using the 30-sample subsets.

---

## Introduction

This project investigates whether internal scores, such as alignment, uniformity, MCR2, and others, can serve as reliable indicators of representation quality.

To test this, we compare representations generated by:

1. Modern SSL methods (MoCo, DINO, SimCLR)  
2. Classical dimensionality reduction methods (PCA, UMAP)

By computing both internal scores and linear probing accuracy across datasets and models, we analyze how well internal metrics correlate with downstream performance and under which conditions they generalize or fail.

---


